<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Primary Meta Tags -->
<title>PDFSmaller - Advanced PDF Compression with Optional Server Processing</title>
<meta name="title" content="PDFSmaller - Compress PDF Files with Client or Server Processing">
<meta name="description" content="Reduce PDF file size with privacy-first client-side compression or optional server processing for maximum compression. 100% free and secure.">
<meta name="keywords" content="compress pdf, reduce pdf size, pdf compressor, shrink pdf, pdf tool, privacy pdf compression, server pdf compression">
<meta name="author" content="PDFSmaller">
<meta name="robots" content="index, follow">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://pdfsmaller.site/">
<meta property="og:title" content="PDFSmaller - Advanced PDF Compression with Optional Server Processing">
<meta property="og:description" content="Choose between privacy-first client-side compression or optional server processing for maximum PDF compression. 100% free and secure.">
<meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23667eea'/%3E%3Cstop offset='100%25' stop-color='%23764ba2'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='1200' height='630' fill='url(%23grad)'/%3E%3Crect x='400' y='180' width='400' height='240' rx='15' fill='rgba(255,255,255,0.9)'/%3E%3Crect x='435' y='225' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Crect x='435' y='275' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Crect x='435' y='325' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Ccircle cx='700' cy='210' r='15' fill='%23e53e3e'/%3E%3Cpath d='M690 210 l5 -5 10 10' stroke='white' stroke-width='3' fill='none'/%3E%3Ctext x='600' y='120' font-family='Arial, sans-serif' font-size='40' font-weight='bold' text-anchor='middle' fill='white'%3EPDFSmaller%3C/text%3E%3Ctext x='600' y='170' font-family='Arial, sans-serif' font-size='30' text-anchor='middle' fill='white'%3EAdvanced PDF Compression%3C/text%3E%3Ctext x='600' y='220' font-family='Arial, sans-serif' font-size='24' text-anchor='middle' fill='white'%3EClient-Side • Optional Server Processing%3C/text%3E%3Ctext x='600' y='550' font-family='Arial, sans-serif' font-size='24' text-anchor='middle' fill='white'%3E100%25 Free • Privacy Focused%3C/text%3E%3C/svg%3E">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://pdfsmaller.site/">
<meta property="twitter:title" content="PDFSmaller - Advanced PDF Compression with Optional Server Processing">
<meta property="twitter:description" content="Choose between privacy-first client-side compression or optional server processing for maximum PDF compression. 100% free and secure.">
<meta property="twitter:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23667eea'/%3E%3Cstop offset='100%25' stop-color='%23764ba2'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='1200' height='630' fill='url(%23grad)'/%3E%3Crect x='400' y='180' width='400' height='240' rx='15' fill='rgba(255,255,255,0.9)'/%3E%3Crect x='435' y='225' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Crect x='435' y='275' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Crect x='435' y='325' width='330' height='30' rx='5' fill='%233182ce'/%3E%3Ccircle cx='700' cy='210' r='15' fill='%23e53e3e'/%3E%3Cpath d='M690 210 l5 -5 10 10' stroke='white' stroke-width='3' fill='none'/%3E%3Ctext x='600' y='120' font-family='Arial, sans-serif' font-size='40' font-weight='bold' text-anchor='middle' fill='white'%3EPDFSmaller%3C/text%3E%3Ctext x='600' y='170' font-family='Arial, sans-serif' font-size='30' text-anchor='middle' fill='white'%3EAdvanced PDF Compression%3C/text%3E%3Ctext x='600' y='220' font-family='Arial, sans-serif' font-size='24' text-anchor='middle' fill='white'%3EClient-Side • Optional Server Processing%3C/text%3E%3Ctext x='600' y='550' font-family='Arial, sans-serif' font-size='24' text-anchor='middle' fill='white'%3E100%25 Free • Privacy Focused%3C/text%3E%3C/svg%3E">

<!-- Google Search Console Intergration-->
 <meta name="google-site-verification" content="ylrJvKlQR-zxl56H7ovlzVGo_9vC941cbgl02yrSbwQ" />
<!-- Canonical URL -->
<link rel="canonical" href="https://pdfsmaller.site/">

<!-- Favicon -->
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='%233182ce'/%3E%3Crect x='35' y='40' width='30' height='20' rx='2' fill='white'/%3E%3Cpath d='M40 45H60V50H40z M40 55H60V60H40z' fill='%233182ce'/%3E%3Ccircle cx='65' cy='40' r='4' fill='%23e53e3e'/%3E%3Cpath d='M62 40L65 37L68 40' stroke='white' stroke-width='1.5' fill='none'/%3E%3C/svg%3E">

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "PDFSmaller",
  "url": "https://pdfsmaller.site/",
  "description": "Reduce PDF file size with privacy-first client-side compression or optional server processing for maximum compression. 100% free and secure.",
  "applicationCategory": "UtilityApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "features": ["Client-side processing", "Optional server processing", "No file uploads", "Privacy-focused"]
}
</script>

<!-- Javscript PDF Compression Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/compressorjs@1.1.1/dist/compressor.min.js"></script>

<!-- Custom Styles -->
<link rel="stylesheet" href="static/style.css" />

</head>
<body>
    <div class="app-container">
        <div class="header">
            <div class="logo-container">
                <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <rect x="20" y="25" width="60" height="50" rx="5" fill="#3182ce"/>
                    <path d="M35 40H65V45H35z M35 50H65V55H35z M35 60H65V65H35z" fill="white"/>
                    <circle cx="75" cy="35" r="5" fill="#e53e3e"/>
                    <path d="M70 35L75 30L80 35" stroke="white" stroke-width="2" fill="none"/>
                </svg>
                <a href="/">
                <h1>PDFSmaller</h1>
                </a>
            </div>
            <p class="subtitle">Advanced PDF compression with client-side and server-side processing options</p>
        </div>

        <div class="panel">
            <h2>Upload PDF</h2>
            <div class="upload-area" id="uploadArea">
                <svg class="upload-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="50" cy="50" r="40" fill="#4a5568" opacity="0.1"/>
                    <path d="M50 35V65M35 50H65" stroke="#667eea" stroke-width="8" stroke-linecap="round"/>
                    <rect x="30" y="25" width="40" height="30" rx="3" fill="#667eea" opacity="0.2"/>
                    <path d="M40 35H60V40H40z M40 45H60V50H40z" fill="#667eea"/>
                </svg>
                <div class="upload-text">Drop your PDF here or click to browse</div>
                <div class="upload-subtext">Maximum file size: 50MB</div>
            </div>
            <input type="file" id="fileInput" class="file-input" accept=".pdf" />

            <div id="fileInfo" class="file-info" style="display: none;">
                <svg class="file-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <rect x="25" y="25" width="50" height="50" rx="5" fill="#3182ce"/>
                    <path d="M35 40H65V45H35z M35 50H65V55H35z M35 60H65V65H35z" fill="white"/>
                </svg>
                <div class="file-details">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-size" id="fileSize"></div>
                </div>
            </div>

            <div class="compression-options">
                <h3>Compression Settings</h3>
                
                <div class="option-group">
                    <label for="compressionLevel">Compression Level:</label>
                    <select id="compressionLevel">
                        <option value="low">Low Compression (Better Quality)</option>
                        <option value="medium" selected>Medium Compression (Balanced)</option>
                        <option value="high">High Compression (Smaller Size)</option>
                        <option value="maximum">Maximum Compression (Smallest Size)</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <label for="imageQuality">Image Quality:</label>
                    <div class="range-container">
                        <input type="range" id="imageQuality" min="10" max="100" value="70">
                        <div class="range-value" id="qualityValue">70%</div>
                    </div>
                </div>
                <div class="option-group">
                    <label for="processingOption">Processing Method:</label>
                    <div class="processing-option">
                        <span>Client-side only</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="serverProcessing">
                            <span class="slider"></span>
                        </label>
                        <span>Server-side enhanced</span>
                    </div>
                    <div id="serverInfo" class="server-info" style="display: none;">
                        <strong>Server-side processing provides better compression</strong> by using advanced algorithms 
                        and image recompression techniques. Your file will be securely uploaded for processing 
                        and automatically deleted after 1 hour.
                    </div>
                </div>
            </div>
            <button id="compressBtn" class="btn" disabled>Compress PDF</button>            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Processing</span>
                    <span id="progressPercentage">0%</span>
                </div>
                <div class="progress">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>
        </div>
        <div class="panel">
            <h2>Compression Results</h2>
            <div id="resultPlaceholder">
                <p>Your compression results will appear here after processing.</p>
                <div class="feature-list">
                    <h3>Advanced Compression Features:</h3>
                    <ul>
                        <li>Client-side compression for privacy and speed</li>
                        <li>Server-side processing for maximum compression</li>
                        <li>Image recompression and optimization</li>
                        <li>PDF structure optimization</li>
                        <li>Metadata removal for smaller file size</li>
                        <li>Color space conversion for efficient compression</li>
                    </ul>
                </div>
            </div>
            <div id="results" class="results" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="originalSize">0 KB</div>
                        <div class="stat-label">Original Size</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="compressedSize">0 KB</div>
                        <div class="stat-label">Compressed Size</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="reductionPercent">0%</div>
                        <div class="stat-label">Size Reduction</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="processingTime">0s</div>
                        <div class="stat-label">Processing Time</div>
                    </div>
                </div>
                <div class="comparison">
                    <div class="file-comparison">
                        <h3>Original File</h3>
                        <div class="comparison-bar comparison-bar-original" id="originalBar"></div>
                        <div id="originalStats"></div>
                    </div>
                    <div class="file-comparison">
                        <h3>Compressed File</h3>
                        <div class="comparison-bar" id="compressedBar"></div>
                        <div id="compressedStats"></div>
                    </div>
                </div>

                <button id="downloadBtn" class="btn btn-success">Download Compressed PDF</button>
                <button id="newFileBtn" class="btn btn-secondary">Process Another File</button>
            </div>

            <div class="social-sharing" id="socialSharing" style="display: none;">
                <h3>Share Your Success</h3>
                <p style="margin-bottom: 15px; color: var(--gray-600);">Help others discover PDFSmaller!</p>
                
                <div class="share-buttons">
                    <button class="share-btn share-btn-native" id="nativeShareBtn">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92S19.61 16.08 18 16.08z"/>
                        </svg>
                        Share
                    </button>
                    
                    <a href="#" class="share-btn share-btn-facebook" id="facebookShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        Facebook
                    </a>
                    
                    <a href="#" class="share-btn share-btn-twitter" id="twitterShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                        </svg>
                        Twitter
                    </a>
                    
                    <a href="#" class="share-btn share-btn-linkedin" id="linkedinShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                        LinkedIn
                    </a>
                    
                    <a href="#" class="share-btn share-btn-whatsapp" id="whatsappShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.89 3.488"/>
                        </svg>
                        WhatsApp
                    </a>
                    
                    <a href="#" class="share-btn share-btn-telegram" id="telegramShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                        </svg>
                        Telegram
                    </a>
                    
                    <a href="#" class="share-btn share-btn-reddit" id="redditShare" target="_blank">
                        <svg class="share-icon" viewBox="0 0 24 24">
                            <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                        </svg>
                        Reddit
                    </a>
                </div>
                
                <div class="share-stats" id="shareStats" style="display: none;">
                    <div class="share-count">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <span id="shareCount">0 shares</span>
                    </div>
                </div>
            </div>



        </div>
    </div>

    <footer>
        <p>PDFSmaller.site - Advanced PDF compression with client-side and server-side processing</p>
    </footer>

<script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const compressionLevel = document.getElementById('compressionLevel');
        const imageQuality = document.getElementById('imageQuality');
        const qualityValue = document.getElementById('qualityValue');
        const serverProcessing = document.getElementById('serverProcessing');
        const serverInfo = document.getElementById('serverInfo');
        const compressBtn = document.getElementById('compressBtn');
        const progressBar = document.getElementById('progressBar');
        const progressPercentage = document.getElementById('progressPercentage');
        const resultPlaceholder = document.getElementById('resultPlaceholder');
        const results = document.getElementById('results');
        const originalSize = document.getElementById('originalSize');
        const compressedSize = document.getElementById('compressedSize');
        const reductionPercent = document.getElementById('reductionPercent');
        const processingTime = document.getElementById('processingTime');
        const originalBar = document.getElementById('originalBar');
        const compressedBar = document.getElementById('compressedBar');
        const originalStats = document.getElementById('originalStats');
        const compressedStats = document.getElementById('compressedStats');
        const downloadBtn = document.getElementById('downloadBtn');
        const newFileBtn = document.getElementById('newFileBtn');

        // State variables
        let selectedFile = null;
        let compressedPdfBlob = null;
        let startTime = null;

        // Event Listeners
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileSelect(files[0]);
            }
        });

        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileSelect(e.target.files[0]);
            }
        });

        imageQuality.addEventListener('input', (e) => {
            qualityValue.textContent = e.target.value + '%';
        });

        serverProcessing.addEventListener('change', (e) => {
            serverInfo.style.display = e.target.checked ? 'block' : 'none';
        });

        compressBtn.addEventListener('click', async () => {
            if (!selectedFile) return;
            startTime = new Date();
            await compressPDF();
        });

        downloadBtn.addEventListener('click', () => {
            if (compressedPdfBlob) {
                const url = URL.createObjectURL(compressedPdfBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = selectedFile.name.replace('.pdf', '_compressed.pdf');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        });

        newFileBtn.addEventListener('click', () => {
            resetUI();
        });

        // Functions
        function handleFileSelect(file) {
            if (file.type !== 'application/pdf') {
                showNotification('Please select a valid PDF file.', 'error');
                return;
            }

            if (file.size > 50 * 1024 * 1024) {
                showNotification('File size must be less than 50MB.', 'error');
                return;
            }

            selectedFile = file;
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            
            fileInfo.style.display = 'flex';
            compressBtn.disabled = false;
            results.style.display = 'none';
            resultPlaceholder.style.display = 'block';
        }

        function updateProgress(percent) {
            progressBar.style.width = percent + '%';
            progressPercentage.textContent = percent + '%';
        }

// Fix 1: Update the compressPDF function to pass imageQuality to server
async function compressPDF() {
    if (!selectedFile) return;

    compressBtn.disabled = true;
    compressBtn.textContent = 'Compressing...';
    compressBtn.classList.add('processing');
    
    try {
        const arrayBuffer = await selectedFile.arrayBuffer();
        updateProgress(20);

        if (serverProcessing.checked) {
            // Server-side processing - NOW PASSING IMAGE QUALITY
            updateProgress(40);
            compressedPdfBlob = await compressWithServer(
                new Uint8Array(arrayBuffer),
                compressionLevel.value,  // Pass compression level
                imageQuality.value       // Pass image quality
            );
            updateProgress(100);
        } else {
            // Client-side processing
            updateProgress(40);
            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
            updateProgress(60);
            
            // Apply compression settings
            const compressionLevelValue = compressionLevel.value;
            const imageQualityValue = parseInt(imageQuality.value); // Get image quality value
            
            const options = {
                useObjectStreams: true,
                addDefaultPage: true,
                objectsPerTick: 100,
            };
            
            // Adjust options based on compression level
            if (compressionLevelValue === 'maximum') {
                options.useObjectStreams = false;
            }
            
            const compressedBytes = await pdfDoc.save(options);
            updateProgress(80);
            
            // Note: PDF-lib doesn't support image quality adjustment directly
            // For true image compression, you'd need to extract images, compress them,
            // and rebuild the PDF - this requires more complex processing
            
            compressedPdfBlob = new Blob([compressedBytes], { type: 'application/pdf' });
            updateProgress(100);
        }
        
        // Calculate and display results
        const endTime = new Date();
        const processingTimeMs = endTime - startTime;
        const originalSizeBytes = selectedFile.size;
        const compressedSizeBytes = compressedPdfBlob.size;
        const compressionRatio = ((originalSizeBytes - compressedSizeBytes) / originalSizeBytes * 100).toFixed(1);
        
        originalSize.textContent = formatFileSize(originalSizeBytes);
        compressedSize.textContent = formatFileSize(compressedSizeBytes);
        reductionPercent.textContent = compressionRatio + '%';
        processingTime.textContent = (processingTimeMs / 1000).toFixed(1) + 's';
        
        // Update comparison bars
        const maxSize = Math.max(originalSizeBytes, compressedSizeBytes);
        const originalWidth = (originalSizeBytes / maxSize * 100).toFixed(1);
        const compressedWidth = (compressedSizeBytes / maxSize * 100).toFixed(1);
        
        originalBar.style.width = originalWidth + '%';
        compressedBar.style.width = compressedWidth + '%';
        
        originalStats.textContent = formatFileSize(originalSizeBytes);
        compressedStats.textContent = formatFileSize(compressedSizeBytes);
        
        // Show results
        resultPlaceholder.style.display = 'none';
        results.style.display = 'block';
        
        showNotification('PDF compressed successfully!', 'success');
        
    } catch (error) {
        console.error('Compression error:', error);
        showNotification('An error occurred during compression. Please try again.', 'error');
    }
    
    compressBtn.disabled = false;
    compressBtn.textContent = 'Compress PDF';
    compressBtn.classList.remove('processing');
}

// Fix 2: Update compressWithServer function signature (it was missing parameters)
async function compressWithServer(pdfBytes, compressionLevel, imageQuality) {
    // Create FormData object
    const formData = new FormData();
    
    // Convert Uint8Array to Blob and append to FormData
    const pdfBlob = new Blob([pdfBytes], { type: 'application/pdf' });
    formData.append('file', pdfBlob, 'document.pdf');
    
    // Add compression parameters
    formData.append('compressionLevel', compressionLevel);
    formData.append('imageQuality', imageQuality);
    
    try {
        // Send to server - update with your production URL
        const response = await fetch('https://api.pdfsmaller.site/api/compress', {
            method: 'POST',
            body: formData
        });
        console.log('Backend Response Status: ', response.ok);
        console.log('Compression Level:', compressionLevel);
        console.log('Image Quality:', imageQuality);
        
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || `Server returned ${response.status}`);
        }
        
        // Return the compressed file as Blob
        return await response.blob();
    } catch (error) {
        console.error('Server compression error:', error);
        throw new Error('Failed to compress PDF on server: ' + error.message);
    }
}
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            // Add icon based on type
            let iconSvg = '';
            if (type === 'success') {
                iconSvg = '<svg class="notification-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#38a169" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
            } else {
                iconSvg = '<svg class="notification-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 14L12 12M12 12L14 10M12 12L10 10M12 12L14 14M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#e53e3e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
            }
            
            notification.innerHTML = `${iconSvg} <span>${message}</span>`;
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }


// Social sharing functionality
class SocialSharing {
    constructor() {
        this.baseUrl = 'https://pdfsmaller.site';
        this.shareCount = 0;
        this.init();
    }

    init() {
        this.setupEventListeners();
        this.loadShareCount();
    }

    setupEventListeners() {
        // Native share button
        const nativeShareBtn = document.getElementById('nativeShareBtn');
        if (nativeShareBtn) {
            nativeShareBtn.addEventListener('click', () => this.nativeShare());
        }

        // Social media share buttons
        const socialButtons = {
            'facebookShare': () => this.shareOnFacebook(),
            'twitterShare': () => this.shareOnTwitter(),
            'linkedinShare': () => this.shareOnLinkedIn(),
            'whatsappShare': () => this.shareOnWhatsApp(),
            'telegramShare': () => this.shareOnTelegram(),
            'redditShare': () => this.shareOnReddit()
        };

        Object.keys(socialButtons).forEach(buttonId => {
            const button = document.getElementById(buttonId);
            if (button) {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    socialButtons[buttonId]();
                    this.trackShare(buttonId.replace('Share', ''));
                });
            }
        });
    }

    getShareData() {
        const compressionResult = this.getCompressionResult();
        
        return {
            title: 'PDFSmaller - Free PDF Compression Tool',
            text: compressionResult ? 
                `I just compressed my PDF and saved ${compressionResult}! Try PDFSmaller - free online PDF compression.` :
                'Compress your PDF files for free with PDFSmaller - client-side or server-side processing available!',
            url: this.baseUrl
        };
    }

    getCompressionResult() {
        const reductionElement = document.getElementById('reductionPercent');
        const originalSizeElement = document.getElementById('originalSize');
        const compressedSizeElement = document.getElementById('compressedSize');
        
        if (reductionElement && originalSizeElement && compressedSizeElement) {
            const reduction = reductionElement.textContent;
            const originalSize = originalSizeElement.textContent;
            const compressedSize = compressedSizeElement.textContent;
            return `${reduction} (from ${originalSize} to ${compressedSize})`;
        }
        return null;
    }

    async nativeShare() {
        if (navigator.share) {
            try {
                const shareData = this.getShareData();
                await navigator.share(shareData);
                this.trackShare('native');
                this.showShareSuccess('Shared successfully!');
            } catch (err) {
                if (err.name !== 'AbortError') {
                    console.error('Error sharing:', err);
                    this.fallbackShare();
                }
            }
        } else {
            this.fallbackShare();
        }
    }

    fallbackShare() {
        // Copy URL to clipboard as fallback
        navigator.clipboard.writeText(this.baseUrl).then(() => {
            this.showShareSuccess('Link copied to clipboard!');
        }).catch(() => {
            this.showShareSuccess('Visit: ' + this.baseUrl);
        });
    }

    shareOnFacebook() {
        const shareData = this.getShareData();
        const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareData.url)}&quote=${encodeURIComponent(shareData.text)}`;
        this.openShareWindow(url);
    }

    shareOnTwitter() {
        const shareData = this.getShareData();
        const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareData.text)}&url=${encodeURIComponent(shareData.url)}&hashtags=PDF,compression,free`;
        this.openShareWindow(url);
    }

    shareOnLinkedIn() {
        const shareData = this.getShareData();
        const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareData.url)}&title=${encodeURIComponent(shareData.title)}&summary=${encodeURIComponent(shareData.text)}`;
        this.openShareWindow(url);
    }

    shareOnWhatsApp() {
        const shareData = this.getShareData();
        const text = `${shareData.text} ${shareData.url}`;
        const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
        this.openShareWindow(url);
    }

    shareOnTelegram() {
        const shareData = this.getShareData();
        const text = `${shareData.text} ${shareData.url}`;
        const url = `https://t.me/share/url?url=${encodeURIComponent(shareData.url)}&text=${encodeURIComponent(shareData.text)}`;
        this.openShareWindow(url);
    }

    shareOnReddit() {
        const shareData = this.getShareData();
        const url = `https://reddit.com/submit?url=${encodeURIComponent(shareData.url)}&title=${encodeURIComponent(shareData.title)}`;
        this.openShareWindow(url);
    }

    openShareWindow(url) {
        const width = 600;
        const height = 400;
        const left = (window.innerWidth - width) / 2;
        const top = (window.innerHeight - height) / 2;
        
        window.open(
            url,
            'share',
            `width=${width},height=${height},left=${left},top=${top},scrollbars=yes,resizable=yes`
        );
    }

    trackShare(platform) {
        this.shareCount++;
        this.updateShareCount();
        this.saveShareCount();
        
        // Track with analytics if available
        if (typeof gtag !== 'undefined') {
            gtag('event', 'share', {
                'method': platform,
                'content_type': 'pdf_compressor',
                'content_id': 'pdfsmaller'
            });
        }
        
        // Visual feedback
        const button = document.querySelector(`[id*="${platform}"]`);
        if (button) {
            button.classList.add('shared');
            setTimeout(() => button.classList.remove('shared'), 300);
        }
    }

    showShareSuccess(message) {
        // Create temporary success message
        const toast = document.createElement('div');
        toast.className = 'notification notification-success show';
        toast.innerHTML = `
            <svg class="notification-icon" viewBox="0 0 24 24" fill="none">
                <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#38a169" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>${message}</span>
        `;
        
        document.body.appendChild(toast);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => document.body.removeChild(toast), 300);
        }, 2000);
    }

    loadShareCount() {
        // Load from localStorage
        const saved = localStorage.getItem('pdfsmaller_shares');
        if (saved) {
            this.shareCount = parseInt(saved) || 0;
            this.updateShareCount();
        }
    }

    saveShareCount() {
        localStorage.setItem('pdfsmaller_shares', this.shareCount.toString());
    }

    updateShareCount() {
        const shareStats = document.getElementById('shareStats');
        const shareCountElement = document.getElementById('shareCount');
        
        if (this.shareCount > 0) {
            shareStats.style.display = 'flex';
            shareCountElement.textContent = `${this.shareCount} share${this.shareCount !== 1 ? 's' : ''}`;
        }
    }

    showSharingPanel() {
        const socialSharing = document.getElementById('socialSharing');
        if (socialSharing) {
            socialSharing.style.display = 'block';
        }
    }

    hideSharingPanel() {
        const socialSharing = document.getElementById('socialSharing');
        if (socialSharing) {
            socialSharing.style.display = 'none';
        }
    }
}

// Initialize social sharing
const socialSharing = new SocialSharing();

// Show sharing panel when compression is complete
// Add this to your existing compressPDF function after showing results:
function showResults() {
    // ... existing results code ...
    
    // Show social sharing
    socialSharing.showSharingPanel();
}

// Hide sharing panel when starting new compression
function resetUI() {
    // ... existing reset code ...
    
    // Hide social sharing
    socialSharing.hideSharingPanel();
}


        function resetUI() {
            selectedFile = null;
            compressedPdfBlob = null;
            fileInput.value = '';
            fileInfo.style.display = 'none';
            compressBtn.disabled = true;
            results.style.display = 'none';
            resultPlaceholder.style.display = 'block';
            progressBar.style.width = '0%';
            progressPercentage.textContent = '0%';
            serverInfo.style.display = 'none';
            serverProcessing.checked = false;

            socialSharing.hideSharingPanel();
        }

        // Initialize
        updateProgress(0);

</script>

</body>
</html>